var se=Object.defineProperty,re=Object.defineProperties;var ie=Object.getOwnPropertyDescriptors;var F=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable;var T=(e,s,t)=>s in e?se(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t,_=(e,s)=>{for(var t in s||(s={}))ne.call(s,t)&&T(e,t,s[t]);if(F)for(var t of F(s))le.call(s,t)&&T(e,t,s[t]);return e},b=(e,s)=>re(e,ie(s));import{f as x}from"./numberFormat.773889d3.js";import{a as oe}from"./iconMaps.0c6dd037.js";import{d as g}from"./dictionarySelector.b7ae9675.js";import{m as v}from"./spyfu-vuex-helpers.esm.87da45d6.js";import{t as h,n as l,a as ce}from"./index.a863b22b.js";import{s as y}from"./selectorMixin.c565e8b6.js";import{j as D,o as H,i as de}from"./vendor.6aa46313.js";import{F as ue}from"./fileUploader.4c7e691c.js";import{f as me}from"./fc_textarea.4c1f24d6.js";import{h as ve}from"./hostSelector.aeb6f968.js";import{D as he}from"./datetime.3af895d2.js";import"./vue-infinite-loading.33b09e95.js";import"./index.09a07ba8.js";import"./index.a9d6c6c2.js";var A={exports:{}},L={exports:{}};(function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s={rotl:function(t,a){return t<<a|t>>>32-a},rotr:function(t,a){return t<<32-a|t>>>a},endian:function(t){if(t.constructor==Number)return s.rotl(t,8)&16711935|s.rotl(t,24)&4278255360;for(var a=0;a<t.length;a++)t[a]=s.endian(t[a]);return t},randomBytes:function(t){for(var a=[];t>0;t--)a.push(Math.floor(Math.random()*256));return a},bytesToWords:function(t){for(var a=[],r=0,i=0;r<t.length;r++,i+=8)a[i>>>5]|=t[r]<<24-i%32;return a},wordsToBytes:function(t){for(var a=[],r=0;r<t.length*32;r+=8)a.push(t[r>>>5]>>>24-r%32&255);return a},bytesToHex:function(t){for(var a=[],r=0;r<t.length;r++)a.push((t[r]>>>4).toString(16)),a.push((t[r]&15).toString(16));return a.join("")},hexToBytes:function(t){for(var a=[],r=0;r<t.length;r+=2)a.push(parseInt(t.substr(r,2),16));return a},bytesToBase64:function(t){for(var a=[],r=0;r<t.length;r+=3)for(var i=t[r]<<16|t[r+1]<<8|t[r+2],n=0;n<4;n++)r*8+n*6<=t.length*8?a.push(e.charAt(i>>>6*(3-n)&63)):a.push("=");return a.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/ig,"");for(var a=[],r=0,i=0;r<t.length;i=++r%4)i!=0&&a.push((e.indexOf(t.charAt(r-1))&Math.pow(2,-2*i+8)-1)<<i*2|e.indexOf(t.charAt(r))>>>6-i*2);return a}};L.exports=s})();var w={utf8:{stringToBytes:function(e){return w.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(w.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var s=[],t=0;t<e.length;t++)s.push(e.charCodeAt(t)&255);return s},bytesToString:function(e){for(var s=[],t=0;t<e.length;t++)s.push(String.fromCharCode(e[t]));return s.join("")}}},R=w;(function(){var e=L.exports,s=R.utf8,t=R.bin,a=function(i){i.constructor==String?i=s.stringToBytes(i):typeof Buffer!="undefined"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(i)?i=Array.prototype.slice.call(i,0):Array.isArray(i)||(i=i.toString());var n=e.bytesToWords(i),d=i.length*8,p=[],f=1732584193,c=-271733879,u=-1732584194,m=271733878,k=-1009589776;n[d>>5]|=128<<24-d%32,n[(d+64>>>9<<4)+15]=d;for(var $=0;$<n.length;$+=16){for(var Z=f,Q=c,X=u,ee=m,te=k,o=0;o<80;o++){if(o<16)p[o]=n[$+o];else{var M=p[o-3]^p[o-8]^p[o-14]^p[o-16];p[o]=M<<1|M>>>31}var ae=(f<<5|f>>>27)+k+(p[o]>>>0)+(o<20?(c&u|~c&m)+1518500249:o<40?(c^u^m)+1859775393:o<60?(c&u|c&m|u&m)-1894007588:(c^u^m)-899497514);k=m,m=u,u=c<<30|c>>>2,c=f,f=ae}f+=Z,c+=Q,u+=X,m+=ee,k+=te}return[f,c,u,m,k]},r=function(i,n){var d=e.wordsToBytes(a(i));return n&&n.asBytes?d:n&&n.asString?t.bytesToString(d):e.bytesToHex(d)};r._blocksize=16,r._digestsize=20,A.exports=r})();var pe=A.exports,fe=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[t("v-row",[t("v-col",{staticClass:"border",attrs:{cols:"6"}},[t("v-card-title",[t("span",[e._v("Select left dictionary"),t("span",{staticClass:"required primary--text"},[e._v(" *")])])])],1),t("v-col",{attrs:{cols:"6"}},[t("v-card-title",[t("span",[e._v("Select right dictionary"),t("span",{staticClass:"required primary--text"},[e._v(" *")])])])],1),t("v-col",{staticClass:"border",attrs:{cols:"6"}},[t("dict-selector",{attrs:{"select-all":""},on:{input:e.checkValid},model:{value:e.leftDicts,callback:function(a){e.leftDicts=a},expression:"leftDicts"}})],1),t("v-col",{attrs:{cols:"6"}},[t("dict-selector",{attrs:{"select-all":""},on:{input:e.checkValid},model:{value:e.rightDicts,callback:function(a){e.rightDicts=a},expression:"rightDicts"}})],1),t("v-col",{staticClass:"border",attrs:{cols:"6"}},[t("v-card-title",[t("span",[e._v("Type left rule")])])],1),t("v-col",{attrs:{cols:"6"}},[t("v-card-title",[t("span",[e._v("Type right rule")])])],1),t("v-col",{staticClass:"border px-2",attrs:{cols:"6"}},[t("v-text-field",{attrs:{outlined:"","single-line":"",placeholder:"Rule"},on:{input:e.checkValid},model:{value:e.ruleLeft,callback:function(a){e.ruleLeft=a},expression:"ruleLeft"}})],1),t("v-col",{staticClass:"px-2",attrs:{cols:"6"}},[t("v-text-field",{attrs:{outlined:"","single-line":"",placeholder:"Rule"},on:{input:e.checkValid},model:{value:e.ruleRight,callback:function(a){e.ruleRight=a},expression:"ruleRight"}})],1)],1)],1)},_e=[];const ke={name:"Combinator",components:{"dict-selector":g},computed:v("jobForm",h(["leftDicts","ruleLeft","rightDicts","ruleRight"])),methods:{checkValid:function(){return this.leftDicts.length>0&&this.rightDicts.length>0}}},N={};var ge=l(ke,fe,_e,!1,ye,"5a56f3a2",null,null);function ye(e){for(let s in N)this[s]=N[s]}var be=function(){return ge.exports}(),xe=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"mask-container"},[t("transition",{attrs:{name:"toolbar-fade"}},[t("v-sheet",{directives:[{name:"show",rawName:"v-show",value:e.focused,expression:"focused"}],staticClass:"charset-toolbar pa-1",attrs:{elevation:8}},[e._l(e.represenArray,function(a,r){return t("v-chip",{key:r,staticClass:"ma-1",attrs:{color:"primary"},on:{click:function(i){return e.addSymbol(r)}}},[e._v(" "+e._s(a.represent)+" ")])}),e._l(e.customCharsets,function(a,r){return t("v-chip",{key:r,staticClass:"ma-1",attrs:{color:"info"},on:{click:function(i){return e.addSymbol(r+1)}}},[e._v(" "+e._s(a.name)+" ")])})],2)],1),t("div",{staticClass:"mask-input"},[t("v-text-field",{ref:"field",attrs:{label:"Enter mask",filled:"",outlined:"",dense:"","single-line":"",rules:e.maskRules,value:e.value},on:{input:function(a){return e.rawValue=a},focus:function(a){e.focused=!0},blur:function(a){e.focused=!1}}}),t("v-btn",{directives:[{name:"show",rawName:"v-show",value:!e.nonRemovable,expression:"!nonRemovable"}],staticClass:"ml-2 remove-button",attrs:{icon:""},on:{click:function(a){return e.$emit("remove")}}},[t("v-icon",[e._v("mdi-delete")])],1)],1)],1)},$e=[];const we={name:"MaskSingle",props:{value:{type:String,default:""},nonRemovable:{type:Boolean,default:!1},customCharsets:{type:[Array,null],default:null}},data(){return{rawValue:"",focused:!1,maskRules:[e=>/^(\?[ludhHsab\?]|[ -~])*$/.test(e)||"Invalid mask",e=>{let s=!1;for(let t of e){if(s){if(t==="?"){s=!1;continue}if(this.represenArray[t]===void 0&&(this.customCharsets==null||!this.customCharsets[parseInt(t)-1]))return`Unknown symbol ?${t}`;s=!1;continue}t==="?"?s=!0:s=!1}return!0}],represenArray:{l:{chars:"abcdefghijklmnopqrstuvwxyz",represent:"a-z"},u:{chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",represent:"A-Z"},d:{chars:"0123456789",represent:"0-9"},h:{chars:"0123456789abcdef",represent:"0-f"},H:{chars:"0123456789ABCDEF",represent:"0-F"},s:{chars:'\xABspace\xBB!"#$%&()*+,-./:;<=>?@[]^_`{|}~',represent:"special"},a:{chars:"?l?u?d?s",represent:"a-z,A-Z,0-9,special"},b:{chars:"0x00 - 0xff",represent:"ASCII"}}}},computed:{},watch:{rawValue(e){this.$emit("input",e)}},methods:{addSymbol:function(e){this.rawValue+="?"+e,this.$refs.field.$el.value=this.rawValue,this.$refs.field.focus()}}},j={};var Se=l(we,xe,$e,!1,Ce,"783512ae",null,null);function Ce(e){for(let s in j)this[s]=j[s]}var S=function(){return Se.exports}(),Me=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("v-data-table",{attrs:{value:e.selected,headers:e.headers,items:e.items,search:e.search,"item-key":"id","show-select":"","single-select":!e.selectAll},on:{input:e.updateSelected},scopedSlots:e._u([{key:"item.name",fn:function(a){var r=a.item;return[t("router-link",{attrs:{to:{name:"charsetDetail",params:{id:r.id}}}},[e._v(" "+e._s(r.name)+" "),t("v-icon",{attrs:{small:"",color:"primary"}},[e._v(" mdi-open-in-new ")])],1)]}},{key:"item.keyspace",fn:function(a){var r=a.item;return[e._v(" "+e._s(e.fmt(r.keyspace))+" ")]}},{key:"item.time",fn:function(a){var r=a.item;return[e._v(" "+e._s(e.$moment(r.time).format("DD.MM.YYYY HH:mm"))+" ")]}}])})},Fe=[];const Te={name:"CharsetSelector",mixins:[y],data(){return{headers:[{text:"Name",align:"start",value:"name"},{text:"Keyspace",value:"keyspace",align:"end"}]}},methods:{fmt:x,getData(){this.loading=!0,this.axios.get(this.$serverAddr+"/charset").then(e=>{this.items=e.data.items,this.loading=!1})},updateSelected(e){e.length>4&&(e=e.slice(1).slice(-4)),this.selected=e,this.$emit("input",e)}}},E={};var De=l(Te,Me,Fe,!1,He,"1afde759",null,null);function He(e){for(let s in E)this[s]=E[s]}var V=function(){return De.exports}(),Ae=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("v-data-table",{attrs:{headers:e.headers,items:e.items,search:e.search,"item-key":"id","show-select":"","single-select":!e.selectAll},on:{input:e.updateSelected},scopedSlots:e._u([{key:"item.data-table-select",fn:function(a){var r=a.select,i=a.isSelected;return[t("v-simple-checkbox",{attrs:{value:i,disabled:e.markovSubmode==0},on:{input:r}})]}},{key:"item.time",fn:function(a){var r=a.item;return[e._v(" "+e._s(e.$moment(r.time).format("DD.MM.YYYY HH:mm"))+" ")]}}]),model:{value:e.selected,callback:function(a){e.selected=a},expression:"selected"}})},Le=[];const Re={name:"MarkovSelector",mixins:[y],props:{value:{type:Array,default:()=>[]},markovSubmode:{type:Number,default:2}},data(){return{headers:[{text:"Name",align:"start",value:"name"},{text:"Added",value:"time",align:"end"}]}},methods:{getData(){this.loading=!0,this.axios.get(this.$serverAddr+"/markovChains").then(e=>{this.items=e.data.items,this.selected=[this.items.find(s=>s.name==="hashcat.hcstat2")],this.loading=!1})}}},I={};var Ne=l(Re,Ae,Le,!1,je,null,null,null);function je(e){for(let s in I)this[s]=I[s]}var Ee=function(){return Ne.exports}(),Ve=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("v-data-table",{attrs:{headers:e.headers,items:e.items,search:e.search,"item-key":"id","show-select":"","single-select":!e.selectAll},on:{input:e.updateSelected},scopedSlots:e._u([{key:"item.name",fn:function(a){var r=a.item;return[t("router-link",{attrs:{to:{name:"maskDetail",params:{id:r.id}}}},[e._v(" "+e._s(r.name)+" "),t("v-icon",{attrs:{small:"",color:"primary"}},[e._v(" mdi-open-in-new ")])],1)]}},{key:"item.time",fn:function(a){var r=a.item;return[e._v(" "+e._s(e.$moment(r.time).format("DD.MM.YYYY HH:mm"))+" ")]}}]),model:{value:e.selected,callback:function(a){e.selected=a},expression:"selected"}})},Ie=[];const Pe={name:"MaskFileSelector",mixins:[y],props:{value:{type:Object,default:function(){return{}}}},data(){return{headers:[{text:"Name",align:"start",value:"name"},{text:"Added",value:"time",align:"end"}]}},computed:{selectedId(){return selected[0].id}},watch:{value(e){this.selected=[e]}},methods:{getData(){this.loading=!0,this.axios.get(this.$serverAddr+"/masks").then(e=>{this.items=e.data.items,this.loading=!1})},updateSelected(){this.$emit("input",this.selected[0])}}},P={};var Ye=l(Pe,Ve,Ie,!1,Be,"4ea5f16c",null,null);function Be(e){for(let s in P)this[s]=P[s]}var qe=function(){return Ye.exports}(),Je=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[t("v-card-title",{staticClass:"pb-0 mb-2"},[t("span",[e._v("Add masks"),t("span",{staticClass:"required primary--text"},[e._v(" *")])])]),t("v-row",{staticClass:"mb-4 px-4"},[t("v-btn",{attrs:{color:"primary",text:""},on:{click:function(a){e.loadMasksDialog=!0}}},[t("v-icon",{attrs:{left:""}},[e._v(" mdi-file-download ")]),e._v(" Load masks ")],1),t("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.masks.length>1,expression:"masks.length > 1"}],attrs:{color:"error",text:""},on:{click:function(a){e.masks=[""]}}},[t("v-icon",{attrs:{left:""}},[e._v(" mdi-restart ")]),e._v(" Reset masks ")],1),t("v-spacer"),t("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.masks.length<50,expression:"masks.length < 50"}],attrs:{color:"success"},on:{click:function(a){return e.addMask()}}},[t("v-icon",{attrs:{left:""}},[e._v(" mdi-plus ")]),e._v(" Add mask ")],1)],1),e.masks.length<50?t("div",{staticClass:"mask-editors"},e._l(e.masks,function(a,r){return t("mask-single",{key:r,attrs:{"non-removable":e.masks.length==1,"custom-charsets":e.charset,value:a},on:{input:function(i){return e.updateMask({index:r,val:i})},remove:function(i){return e.deleteMask(r)}}})}),1):t("v-alert",{attrs:{type:"info"}},[e._v(" Not showing "+e._s(e.masks.length)+" masks to maintain performance and conciseness. ")]),t("v-row",[t("v-col",{staticClass:"border",attrs:{cols:"6"}},[t("v-card-title",[t("span",[e._v("Select charsets (max. 4)")])]),t("charset-selector",{attrs:{"select-all":""},model:{value:e.charset,callback:function(a){e.charset=a},expression:"charset"}})],1),t("v-col",{attrs:{cols:"6"}},[t("v-card-title",[t("span",[e._v("Markov file")])]),t("markov-selector",{attrs:{"markov-submode":e.submode},on:{input:e.checkValid},model:{value:e.markov,callback:function(a){e.markov=a},expression:"markov"}}),t("v-row",[t("v-col",{staticClass:"pl-2",attrs:{cols:"6"}},[t("v-radio-group",{attrs:{column:""},on:{change:e.checkValid},model:{value:e.submode,callback:function(a){e.submode=a},expression:"submode"}},[t("v-radio",{attrs:{label:"Markov disabled",color:"primary",value:0}}),t("v-radio",{attrs:{label:"2D Markov",color:"primary",value:1}}),t("v-radio",{attrs:{label:"3D Markov",color:"primary",value:2}})],1)],1),t("v-col",{staticClass:"pr-2",attrs:{cols:"6"}},[t("v-text-field",{attrs:{type:"number",disabled:e.submode===0,label:"Markov threshold",filled:"",dense:"",mask:"########"},on:{input:e.checkValid},model:{value:e.markovThresh,callback:function(a){e.markovThresh=a},expression:"markovThresh"}})],1)],1)],1)],1),t("v-dialog",{attrs:{"max-width":"600"},model:{value:e.loadMasksDialog,callback:function(a){e.loadMasksDialog=a},expression:"loadMasksDialog"}},[t("v-card",[t("v-card-text",[t("maskFile-selector",{on:{input:e.checkValid},model:{value:e.maskFile,callback:function(a){e.maskFile=a},expression:"maskFile"}})],1),t("v-card-actions",[t("v-btn",{attrs:{color:"primary",disabled:!e.maskFile},on:{click:e.loadMasksFromFile}},[e._v(" Load ")])],1)],1)],1)],1)},We=[];const Ue={name:"FcMask",components:{CharsetSelector:V,"mask-single":S,"charset-selector":V,"markov-selector":Ee,"maskFile-selector":qe},data:function(){return{loadMasksDialog:!1,maskFile:null}},computed:_({},v("jobForm",h(["masks","submode","markovThresh","markov","charset"]))),methods:b(_({},D("jobForm",["addMask","deleteMask","updateMask","mergeMasks"])),{loadMasksFromFile:function(){this.axios.get(this.$serverAddr+"/masks/"+this.maskFile.id).then(e=>{var s=e.data.data.split(`
`);this.mergeMasks(s),this.maskFile=null,this.loadMasksDialog=!1,this.checkValid()})},checkValid:function(){return this.masks[0]!==""}})},Y={};var Ke=l(Ue,Je,We,!1,Oe,"121b1ce5",null,null);function Oe(e){for(let s in Y)this[s]=Y[s]}var ze=function(){return Ke.exports}(),Ge=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("v-data-table",{attrs:{headers:e.headers,items:e.items,search:e.search,"item-key":"id","show-select":"","single-select":!e.selectAll},on:{input:e.updateSelected},scopedSlots:e._u([{key:"item.name",fn:function(a){var r=a.item;return[t("router-link",{attrs:{to:{name:"ruleDetail",params:{id:r.id}}}},[e._v(" "+e._s(r.name)+" "),t("v-icon",{attrs:{small:"",color:"primary"}},[e._v(" mdi-open-in-new ")])],1)]}},{key:"item.count",fn:function(a){var r=a.item;return[e._v(" "+e._s(e.fmt(r.count))+" ")]}},{key:"item.time",fn:function(a){var r=a.item;return[e._v(" "+e._s(e.$moment(r.time).format("DD.MM.YYYY HH:mm"))+" ")]}}]),model:{value:e.selected,callback:function(a){e.selected=a},expression:"selected"}})},Ze=[];const Qe={name:"RulesSelector",mixins:[y],data(){return{headers:[{text:"Name",align:"start",value:"name"},{text:"Count",value:"count",align:"end"},{text:"Added",value:"time",align:"end"}]}},methods:{fmt:x,getData(){this.loading=!0,this.axios.get(this.$serverAddr+"/rule").then(e=>{this.items=e.data.items,this.loading=!1})}}},B={};var Xe=l(Qe,Ge,Ze,!1,et,null,null,null);function et(e){for(let s in B)this[s]=B[s]}var C=function(){return Xe.exports}(),tt=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[t("v-card-title",[t("span",[e._v("Select dictionary"),t("span",{staticClass:"required primary--text"},[e._v(" *")])])]),t("dict-selector",{attrs:{"select-all":""},on:{input:e.checkValid},model:{value:e.leftDicts,callback:function(a){e.leftDicts=a},expression:"leftDicts"}}),t("v-divider"),t("v-card-title",[t("span",[e._v("Fragmentation of dictionaries")])]),t("v-radio-group",{model:{value:e.distributionMode,callback:function(a){e.distributionMode=a},expression:"distributionMode"}},[t("v-radio",{attrs:{label:"On server",value:0}}),t("v-radio",{attrs:{label:"On hosts",value:1}})],1),t("v-divider"),t("v-card-title",[t("span",[e._v("Select rule file")])]),t("rules-selector",{on:{input:e.checkValid},model:{value:e.rules,callback:function(a){e.rules=a},expression:"rules"}})],1)},at=[];const st={name:"Dictionary",components:{"dict-selector":g,"rules-selector":C},computed:v("jobForm",h(["leftDicts","rules","distributionMode"])),methods:{checkValid:function(){return this.leftDicts.length>0}}},q={};var rt=l(st,tt,at,!1,it,"e4719d94",null,null);function it(e){for(let s in q)this[s]=q[s]}var nt=function(){return rt.exports}(),lt=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[t("v-row",[t("v-col",{staticClass:"border",attrs:{cols:"6"}},[t("v-card-title",[t("span",[e._v("Type mask"),t("span",{staticClass:"required primary--text"},[e._v(" *")])])])],1),t("v-col",{attrs:{cols:"6"}},[t("v-card-title",[t("span",[e._v("Select dictionary"),t("span",{staticClass:"required primary--text"},[e._v(" *")])])])],1),t("v-col",{staticClass:"border",attrs:{cols:"6"}},[t("mask-single",{attrs:{"non-removable":""},on:{input:e.checkValid},model:{value:e.hybridMask,callback:function(a){e.hybridMask=a},expression:"hybridMask"}})],1),t("v-col",{attrs:{cols:"6"}},[t("dict-selector",{attrs:{"select-all":""},on:{input:e.checkValid},model:{value:e.rightDicts,callback:function(a){e.rightDicts=a},expression:"rightDicts"}}),t("v-card-title",[t("span",[e._v("Type rule")])]),t("v-text-field",{attrs:{outlined:"","single-line":"",placeholder:"Rule"},on:{input:e.checkValid},model:{value:e.ruleRight,callback:function(a){e.ruleRight=a},expression:"ruleRight"}})],1)],1)],1)},ot=[];const ct={name:"HybridWordlistMask",components:{"mask-single":S,"dict-selector":g},data:function(){return{attackId:7,attackName:"Hybrid mask+wordlist",maskRules:[e=>/^(\?[ludhHsab]|[ -~])+$/.test(e)||"Not valid mask"]}},computed:v("jobForm",h(["ruleLeft","rightDicts","ruleRight","hybridMask"])),methods:{dictSelected:function(e,s){this.selectedDict2Id=e,this.checkValid()},checkValid:function(){return this.hybridMask!==""&&this.rightDicts.length>0}}},J={};var dt=l(ct,lt,ot,!1,ut,"1a58b564",null,null);function ut(e){for(let s in J)this[s]=J[s]}var mt=function(){return dt.exports}(),vt=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[t("v-row",[t("v-col",{staticClass:"border",attrs:{cols:"6"}},[t("v-card-title",[t("span",[e._v("Select dictionary"),t("span",{staticClass:"required primary--text"},[e._v(" *")])])])],1),t("v-col",{attrs:{cols:"6"}},[t("v-card-title",[t("span",[e._v("Type mask"),t("span",{staticClass:"required primary--text"},[e._v(" *")])])])],1),t("v-col",{staticClass:"border",attrs:{cols:"6"}},[t("dict-selector",{attrs:{"select-all":""},on:{input:e.checkValid},model:{value:e.leftDicts,callback:function(a){e.leftDicts=a},expression:"leftDicts"}}),t("v-card-title",[t("span",[e._v("Type rule")])]),t("v-text-field",{attrs:{outlined:"","single-line":"",placeholder:"Rule"},on:{input:e.checkValid},model:{value:e.ruleLeft,callback:function(a){e.ruleLeft=a},expression:"ruleLeft"}})],1),t("v-col",{attrs:{cols:"6"}},[t("mask-single",{attrs:{"non-removable":""},on:{input:e.checkValid},model:{value:e.hybridMask,callback:function(a){e.hybridMask=a},expression:"hybridMask"}})],1)],1)],1)},ht=[];const pt={name:"HybridMaskWordlist",components:{"mask-single":S,"dict-selector":g},data:function(){return{attackId:6,attackName:"Hybrid wordlist+mask",maskRules:[e=>/^(\?[ludhHsab]|[ -~])+$/.test(e)||"Not valid mask"]}},computed:v("jobForm",h(["ruleLeft","leftDicts","ruleRight","hybridMask"])),methods:{checkValid:function(){return this.hybridMask!==""&&this.leftDicts.length>0}}},W={};var ft=l(pt,vt,ht,!1,_t,"258e2026",null,null);function _t(e){for(let s in W)this[s]=W[s]}var kt=function(){return ft.exports}(),gt=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("v-data-table",{attrs:{headers:e.headers,items:e.items,search:e.search,"item-key":"id","show-select":"","single-select":!e.selectAll},on:{input:e.updateSelected},scopedSlots:e._u([{key:"item.name",fn:function(a){var r=a.item;return[t("router-link",{attrs:{to:{name:"pcfgDetail",params:{id:r.id}}}},[e._v(" "+e._s(r.name)+" "),t("v-icon",{attrs:{small:"",color:"primary"}},[e._v(" mdi-open-in-new ")])],1)]}},{key:"item.keyspace",fn:function(a){var r=a.item;return[e._v(" "+e._s(e.fmt(r.keyspace))+" ")]}},{key:"item.time_added",fn:function(a){var r=a.item;return[e._v(" "+e._s(e.$moment(r.time_added).format("DD.MM.YYYY HH:mm"))+" ")]}}]),model:{value:e.selected,callback:function(a){e.selected=a},expression:"selected"}})},yt=[];const bt={name:"PcfgSelector",mixins:[y],data(){return{headers:[{text:"Name",align:"start",value:"name"},{text:"Keyspace",value:"keyspace",align:"end"},{text:"Added",value:"time_added",align:"end"}]}},watch:{value:function(){this.value&&(this.selected=this.value)}},methods:{fmt:x,getData(){this.loading=!0,this.axios.get(this.$serverAddr+"/pcfg").then(e=>{this.items=e.data.items,this.loading=!1})}}},U={};var xt=l(bt,gt,yt,!1,$t,null,null,null);function $t(e){for(let s in U)this[s]=U[s]}var wt=function(){return xt.exports}(),St=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[t("v-card-title",[t("span",[e._v("Select PCFG grammar"),t("span",{staticClass:"required primary--text"},[e._v(" *")])])]),t("pcfg-selector",{model:{value:e.pcfg,callback:function(a){e.pcfg=a},expression:"pcfg"}}),t("v-card-title",[t("span",[e._v("Edit keyspace limit")])]),t("v-text-field",{attrs:{outlined:"","single-line":"",required:"",type:"number",suffix:"passwords",max:e.pcfg.length>0?e.pcfg[0].keyspace:0},on:{blur:e.checkValid},model:{value:e.keyspaceLimit,callback:function(a){e.keyspaceLimit=e._n(a)},expression:"keyspaceLimit"}}),t("v-divider"),t("v-card-title",[t("span",[e._v("Select rule file")])]),t("rules-selector",{model:{value:e.rules,callback:function(a){e.rules=a},expression:"rules"}})],1)},Ct=[];const Mt={name:"Pcfg",components:{"pcfg-selector":wt,"rules-selector":C},data:function(){return{attackId:9,attackName:"pcfg"}},watch:{pcfg(e){e.length>0&&(this.keyspaceLimit=e[0].keyspace)}},computed:v("jobForm",h(["rules","pcfg","keyspaceLimit"])),methods:{checkValid:function(){this.pcfg.length>0&&this.keyspaceLimit>this.pcfg[0].keyspace&&(this.keyspaceLimit=this.pcfg[0].keyspace)}}},K={};var Ft=l(Mt,St,Ct,!1,Tt,"2a76bf20",null,null);function Tt(e){for(let s in K)this[s]=K[s]}var Dt=function(){return Ft.exports}(),Ht=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[t("v-card-title",[t("span",[e._v("Select dictionary"),t("span",{staticClass:"required primary--text"},[e._v(" *")])])]),t("dict-selector",{attrs:{"select-all":""},on:{input:e.checkValid},model:{value:e.leftDicts,callback:function(a){e.leftDicts=a},expression:"leftDicts"}}),t("v-divider"),t("v-checkbox",{attrs:{label:"Check for password duplicates"},model:{value:e.checkDuplicates,callback:function(a){e.checkDuplicates=a},expression:"checkDuplicates"}}),t("v-divider"),t("v-checkbox",{attrs:{label:"Case permutation"},model:{value:e.casePermute,callback:function(a){e.casePermute=a},expression:"casePermute"}}),t("v-divider"),t("v-card-title",[t("span",[e._v("Minimal length of passwords (1 - 32)")])]),t("v-card-text",[t("v-text-field",{attrs:{text:"","single-line":"",value:e.minPasswordLen,required:"",type:"number",min:"1",max:"32"},on:{input:e.checkValid},model:{value:e.minPasswordLen,callback:function(a){e.minPasswordLen=e._n(a)},expression:"minPasswordLen"}})],1),t("v-divider"),t("v-card-title",[t("span",[e._v("Maximal length of passwords (1 - 32)")])]),t("v-card-text",[t("v-text-field",{attrs:{text:"","single-line":"",value:e.maxPasswordLen,required:"",type:"number",min:"1",max:"32"},on:{input:e.checkValid},model:{value:e.maxPasswordLen,callback:function(a){e.maxPasswordLen=e._n(a)},expression:"maxPasswordLen"}})],1),t("v-divider"),t("v-card-title",[t("span",[e._v("Minimal number of elements per chain (1 - 16)")])]),t("v-card-text",[t("v-text-field",{attrs:{text:"","single-line":"",value:e.minElemInChain,required:"",type:"number",min:"1",max:"16"},on:{input:e.checkValid},model:{value:e.minElemInChain,callback:function(a){e.minElemInChain=e._n(a)},expression:"minElemInChain"}})],1),t("v-divider"),t("v-card-title",[t("span",[e._v("Maximal number of elements per chain (1 - 16)")])]),t("v-card-text",[t("v-text-field",{attrs:{text:"","single-line":"",value:e.maxElemInChain,required:"",type:"number",min:"1",max:"16"},on:{input:e.checkValid},model:{value:e.maxElemInChain,callback:function(a){e.maxElemInChain=e._n(a)},expression:"maxElemInChain"}})],1),t("v-card-title",[t("span",[e._v("Edit keyspace limit")])]),t("v-text-field",{attrs:{text:"","single-line":"",value:e.keyspaceLimit,required:"",type:"number",suffix:"passwords",min:"0",max:"keyspace"},on:{input:e.checkValid},model:{value:e.keyspaceLimit,callback:function(a){e.keyspaceLimit=e._n(a)},expression:"keyspaceLimit"}}),t("v-divider"),t("v-card-title",[t("span",[e._v("Select rule file")])]),t("rules-selector",{on:{input:e.checkValid},model:{value:e.rules,callback:function(a){e.rules=a},expression:"rules"}}),t("v-card-title",[t("span",[e._v("Generate random rules")])]),t("v-text-field",{attrs:{text:"","single-line":"",value:e.generateRandomRules,required:"",type:"number",suffix:"rules",min:"0"},on:{input:e.checkValid},model:{value:e.generateRandomRules,callback:function(a){e.generateRandomRules=e._n(a)},expression:"generateRandomRules"}})],1)},At=[];const Lt={name:"Prince",components:{"dict-selector":g,"rules-selector":C},props:["keyspace"],watch:{keyspace(e){this.keyspaceLimit=e}},computed:v("jobForm",h(["leftDicts","rules","checkDuplicates","casePermute","minPasswordLen","maxPasswordLen","minElemInChain","maxElemInChain","keyspaceLimit","generateRandomRules"])),methods:{checkValid:function(){return this.minPasswordLen<=0?(this.$error("Minimal length of passwords must be greater than 0."),!1):this.maxPasswordLen<=0?(this.$error("Maximal length of passwords must be greater than 0."),!1):this.maxPasswordLen>32?(this.$error("Maximal length of passwords must be smaller or equal to 32."),!1):this.minElemInChain<=0?(this.$error("Minimal number of elements per chain must be greater than 0."),!1):this.maxElemInChain<=0?(this.$error("Maximal number of elements per chain must be greater than 0."),!1):this.maxElemInChain>16?(this.$error("Maximal number of elements per chain must be to 16."),!1):this.minPasswordLen>this.maxPasswordLen?(this.$error("Minimal length of passwords must be greater than maximal length of passwords."),!1):this.minElemInChain>this.maxElemInChain?(this.$error("Minimal number of elements per chain must be smaller or equal than maximal number of elements per chain."),!1):this.maxElemInChain>this.maxPasswordLen?(this.$error("Maximal number of elements per chain must be smaller or equal than maximal length of passwords."),!1):this.keyspaceLimit<0?(this.$error("Keyspace limit must be nonnegative value."),!1):this.generateRandomRules<0?(this.$error("Random rules count must be nonnegative value."),!1):this.rules.length>0&&this.generateRandomRules>0?(this.$error("Cannot combine a rule file together with random rules generation."),!1):(this.$hideAlert(),!0)}}},O={};var Rt=l(Lt,Ht,At,!1,Nt,"439f26cf",null,null);function Nt(e){for(let s in O)this[s]=O[s]}var jt=function(){return Rt.exports}(),Et=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("v-dialog",{attrs:{width:"800"},scopedSlots:e._u([{key:"activator",fn:function(a){var r=a.on;return[t("v-btn",e._g({attrs:{disabled:!e.validTemplate,large:"",color:"primary"},on:{click:e.nameMe}},r),[t("v-icon",{attrs:{left:""}},[e._v(" mdi-file-plus ")]),e._v("Manage Template ")],1)]}}]),model:{value:e.dialog,callback:function(a){e.dialog=a},expression:"dialog"}},[t("v-card",[t("v-card-title",{attrs:{"primary-title":""}},[e._v(" Job template ")]),t("v-card-text",[t("div",{staticClass:"flex mb-3"},[t("v-icon",{attrs:{left:""}},[e._v(" info ")]),t("div",[e._v(" The choices you made in the job configuration will be saved as a template."),t("br"),e._v(" You can pre-fill any new job configuration with templates you saved. "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.name!==""&&e.name===e.inheritedName,expression:"name !== '' && name === inheritedName"}]},[e._v(" Keep the name to update an existing template. ")])])],1),t("v-text-field",{attrs:{id:"templateName",name:"templateName",outlined:"",dense:"","hide-details":"",label:"Template name"},model:{value:e.name,callback:function(a){e.name=a},expression:"name"}})],1),t("v-card-actions",[t("v-spacer"),t("v-btn",{attrs:{text:""},on:{click:function(a){e.dialog=!e.dialog}}},[e._v(" Back to editing ")]),t("v-btn",{attrs:{color:"primary",text:"",disabled:e.name===""},on:{click:e.submit}},[e._v(" "+e._s(e.name!==""&&e.name===e.inheritedName?"Update":"Save")+" template ")])],1)],1)],1)},Vt=[];const It={name:"TemplateModal",props:{inheritedName:{type:String,default:""}},data(){return{dialog:!1,name:""}},computed:H("jobForm",["validTemplate"]),methods:{submit(){const e=this.$store.getters["jobForm/makeTemplate"](this.name);console.log(e),this.loading=!0,this.axios.put(this.$serverAddr+"/template",e).then(s=>{this.$emit("templatesUpdated")}).catch(s=>{this.loading=!1}),this.dialog=!1},nameMe(){this.name=this.inheritedName}}},z={};var Pt=l(It,Et,Vt,!1,Yt,"6bb7b305",null,null);function Yt(e){for(let s in z)this[s]=z[s]}var Bt=function(){return Pt.exports}(),qt=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"containerAddJob height100 mx-auto"},[t("v-scale-transition",[t("v-sheet",{directives:[{name:"show",rawName:"v-show",value:e.keyspaceKnown&&e.keyspace||e.estimatedTime,expression:"keyspaceKnown && keyspace || estimatedTime"}],staticClass:"infobar",attrs:{color:"info",dark:"",elevation:"8"}},[t("div",{staticClass:"d-flex"},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.keyspace,expression:"keyspace"}],staticClass:"text-end"},[t("div",{staticClass:"overline"},[t("v-icon",{staticClass:"mr-1",attrs:{"x-small":""}},[e._v(" mdi-key ")]),t("span",[e._v(" Keyspace ")])],1),t("div",[e._v(e._s(e.numberFormat(e.keyspace)))])]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.estimatedTime,expression:"estimatedTime"}],staticClass:"ml-4 text-end"},[t("div",{staticClass:"overline"},[t("v-icon",{staticClass:"mr-1",attrs:{"x-small":""}},[e._v(" mdi-timelapse ")]),t("span",[e._v(" Est. cracking time ")])],1),t("div",[e._v(e._s(e.estimatedTime))])])])])],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"loadingProgressCont"},[t("v-progress-circular",{staticClass:"loadingProgress",attrs:{indeterminate:"",color:"primary",size:"65",width:4}})],1),t("v-row",[t("v-col",[t("v-text-field",{attrs:{outlined:"",autofocus:"",required:"",label:"Name",hint:"Give this job a descriptive name","persistent-hint":""},model:{value:e.name,callback:function(a){e.name=a},expression:"name"}}),e.dev?t("v-btn",{attrs:{text:"",color:"success"},on:{click:e.generateJobName}},[t("v-icon",{attrs:{left:""}},[e._v(" mdi-auto-fix ")]),e._v(" Generate ")],1):e._e()],1),t("v-col",[t("v-autocomplete",{attrs:{items:e.templates,"item-text":"name","item-value":"id",value:e.selectedTemplate,"auto-select-first":"",outlined:"",label:"Template",hint:"Prefill the form with a saved template (use empty to quickly reset)","persistent-hint":""},on:{input:e.fetchAndApplyTemplate}})],1)],1),t("div",[t("v-col",[t("v-stepper",{staticClass:"mb-4",attrs:{vertical:"","non-linear":""},model:{value:e.step,callback:function(a){e.step=a},expression:"step"}},[t("v-stepper-step",{attrs:{editable:"",step:"1"}},[e._v(" Input settings ")]),t("v-stepper-content",{attrs:{step:"1"}},[t("v-container",[t("v-row",{staticClass:"mb-4"},[t("v-btn-toggle",{staticClass:"mr-2",attrs:{mandatory:"",color:"primary"},model:{value:e.inputMethod,callback:function(a){e.inputMethod=a},expression:"inputMethod"}},[t("v-btn",{attrs:{value:"multipleHashes"}},[e._v(" Manual entry ")]),t("v-btn",{attrs:{value:"hashFile"}},[e._v(" From hash file ")]),t("v-btn",{attrs:{value:"extractFromFile"}},[e._v(" Extract from file ")])],1),t("v-autocomplete",{attrs:{editable:"","validate-on-blur":"",clearable:"",label:"Select hash type",items:e.hashTypes,"item-text":"name",filter:e.hashTypeFilter,"return-object":"",required:"","hide-details":"","single-line":"",flat:"","solo-inverted":"","no-data-text":"No matching hash type"},on:{change:function(a){return e.validateHashes(null)}},scopedSlots:e._u([{key:"item",fn:function(a){var r=a.item;return[t("v-list-item-content",[t("v-list-item-title",[t("b",[e._v(e._s(r.code))]),e._v(" - "+e._s(r.name))])],1)]}}]),model:{value:e.hashType,callback:function(a){e.hashType=a},expression:"hashType"}})],1),t("v-row",[e.inputMethod==="extractFromFile"?t("v-col",{attrs:{cols:"12"}},[t("v-alert",{attrs:{type:"info",text:""}},[e._v(" Supported formats: "),t("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(a){var r=a.on;return[t("span",e._g({},r),[t("a",{staticClass:"filetype-link",attrs:{href:"#"}},[e._v("MS_OFFICE")]),e._v(",")])]}}],null,!1,4231528392)},[t("span",[e._v("Hash types: 9400, 9500, 9600, 9700, 9800")])]),t("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(a){var r=a.on;return[t("span",e._g({},r),[t("a",{staticClass:"filetype-link",attrs:{href:"#"}},[e._v("PDF")]),e._v(",")])]}}],null,!1,2332527323)},[t("span",[e._v("Hash types: 10400, 10500, 10600, 10700")])]),t("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(a){var r=a.on;return[t("span",e._g({},r),[t("a",{staticClass:"filetype-link",attrs:{href:"#"}},[e._v("7Z")]),e._v(",")])]}}],null,!1,3020928356)},[t("span",[e._v("Hash type: 11600")])]),t("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(a){var r=a.on;return[t("span",e._g({},r),[t("a",{staticClass:"filetype-link",attrs:{href:"#"}},[e._v("RAR")]),e._v(" and ")])]}}],null,!1,3417299535)},[t("span",[e._v("Hash types: 12500, 13000")])]),t("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(a){var r=a.on;return[t("span",e._g({},r),[t("a",{staticClass:"filetype-link",attrs:{href:"#"}},[e._v("ZIP")]),e._v(".")])]}}],null,!1,4251728136)},[t("span",[e._v("Hash types: 13600")])])],1),t("file-uploader",{ref:"encryptedFileUploader",attrs:{url:this.$serverAddr+"/protectedFiles/add"},on:{uploadComplete:e.uploadComplete}})],1):e._e(),e.inputMethod==="hashFile"?t("v-col",{attrs:{cols:"12"}},[t("v-alert",{attrs:{type:"info",text:""}},[e._v(" Input to hashcat. Select a binary hash (WPA/WPA2), or plain text hashlist. ")]),t("file-uploader",{ref:"hashFileUploader",attrs:{multiple:!1,"no-upload":"",label:"Select a file to read"},on:{filesChanged:e.hashFileSelected}})],1):e._e(),t("v-col",{attrs:{cols:"12"}},[t("v-alert",{staticClass:"mt-0 mb-0",attrs:{value:e.gotBinaryHash,text:"",type:"info",color:"primary"}},[e._v(" You can select only one binary hash. ")]),e.inputMethod!==null?t("fc-textarea",{ref:"textarea",staticClass:"textarea",class:{hasherror:e.hashListError},attrs:{"max-height":"500",readonly:!(e.inputMethod==="multipleHashes"&&!e.gotBinaryHash),"can-remove-line":!0},on:{blur:e.validateHashes,focus:e.unvalidateHashes},model:{value:e.hashList,callback:function(a){e.hashList=a},expression:"hashList"}},[t("div",{staticClass:"hashCeckContainer pl-1 pt-2",attrs:{slot:"after"},slot:"after"},e._l(e.validatedHashes,function(a){return t("div",{key:a.id},[a.result==="OK"?t("v-icon",{attrs:{small:"",color:"success"}},[e._v(" check_circle_outlined ")]):t("v-tooltip",{attrs:{left:""},scopedSlots:e._u([{key:"activator",fn:function(r){var i=r.on;return[t("v-icon",e._g({staticClass:"clickable",attrs:{small:"",color:"error"}},i),[e._v(" error_circle_outlined ")])]}}],null,!0)},[t("span",[e._v(e._s(a.result))])]),a.isInCache?t("v-tooltip",{attrs:{left:""},scopedSlots:e._u([{key:"activator",fn:function(r){var i=r.on;return[t("v-icon",e._g({staticClass:"clickable",attrs:{small:"",color:"warning"}},i),[e._v(" error_circle_outlined ")])]}}],null,!0)},[t("span",[e._v("hash already in hashcache")])]):e._e()],1)}),0)]):e._e()],1)],1),t("v-row",[e.dev?t("v-btn",{attrs:{text:"",color:"success"},on:{click:e.getRandomHash}},[t("v-icon",{attrs:{left:""}},[e._v(" mdi-auto-fix ")]),e._v(" Random SHA1 ")],1):e._e(),t("v-checkbox",{directives:[{name:"show",rawName:"v-show",value:e.invalidHashes.length>0,expression:"invalidHashes.length > 0"}],staticClass:"ml-2 mt-1",attrs:{label:"Ignore invalid hashes","hide-details":"",height:15,color:"error"},model:{value:e.ignoreHashes,callback:function(a){e.ignoreHashes=a},expression:"ignoreHashes"}}),t("v-spacer"),t("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.hashList!=="",expression:"hashList !== ''"}],staticClass:"mr-2",attrs:{color:"error",text:""},on:{click:e.clearInput}},[e._v(" Reset ")]),t("v-btn",{attrs:{color:"primary"},on:{click:function(a){e.step=2}}},[e._v(" Next ")])],1)],1)],1),t("v-stepper-step",{attrs:{editable:"",step:"2"}},[e._v(" Attack settings ")]),t("v-stepper-content",{attrs:{step:"2"}},[t("v-container",[t("v-card-title",[e._v("Attack mode")]),t("v-item-group",{staticClass:"d-flex flex-wrap justify-space-between",model:{value:e.attackSettingsTab,callback:function(a){e.attackSettingsTab=a},expression:"attackSettingsTab"}},e._l(e.attacks,function(a,r){return t("v-item",{key:r,attrs:{value:a.handler},scopedSlots:e._u([{key:"default",fn:function(i){var n=i.active,d=i.toggle;return[t("v-btn",{staticClass:"mode-btn",attrs:{text:"",small:"",color:n?"primary":""},on:{click:d}},[t("div",{staticClass:"my-3"},[t("v-icon",{staticClass:"mb-2"},[e._v(" "+e._s(e.attackIcon(a.handler))+" ")]),t("div",[e._v(e._s(a.name))])],1)])]}}],null,!0)})}),1),t(e.attackSettingsTab,{tag:"v-component",attrs:{keyspace:e.keyspace}}),t("v-row",[t("v-spacer"),t("v-btn",{staticClass:"mr-6 mt-4",attrs:{color:"primary"},on:{click:function(a){e.step=3}}},[e._v(" Next ")])],1)],1)],1),t("v-stepper-step",{attrs:{editable:"",step:"3"}},[e._v(" Host assignment ")]),t("v-stepper-content",{attrs:{step:"3"}},[t("v-subheader",[e._v("Select which hosts to distribute workunits to")]),t("div",{staticClass:"scroller"},[t("host-selector",{attrs:{"select-all":"","auto-refresh":""},model:{value:e.hosts,callback:function(a){e.hosts=a},expression:"hosts"}})],1),t("v-subheader",[t("b",[e._v("("+e._s(e.hosts.length)+" selected)")])]),t("v-row",[t("v-spacer"),t("v-btn",{staticClass:"mr-6 mt-4",attrs:{color:"primary"},on:{click:function(a){e.step=4}}},[e._v(" Next ")])],1)],1),t("v-stepper-step",{attrs:{editable:"",step:"4"}},[e._v(" Additional settings ")]),t("v-stepper-content",{attrs:{step:"4"}},[t("v-container",[t("v-row",[t("v-textarea",{attrs:{label:"Comment",outlined:"","auto-grow":"",rows:1},model:{value:e.comment,callback:function(a){e.comment=a},expression:"comment"}})],1),t("v-row",[t("v-col",[t("div",{staticClass:"title mb-2"},[e._v("Planned start")]),t("dt-picker",{attrs:{outlined:"","hide-details":"",disabled:e.startNow,"single-line":"",label:""},model:{value:e.startDate,callback:function(a){e.startDate=a},expression:"startDate"}}),t("v-checkbox",{attrs:{label:"Immediately"},model:{value:e.startNow,callback:function(a){e.startNow=a},expression:"startNow"}})],1),t("v-col",[t("div",{staticClass:"title mb-2"},[e._v(" Desired time per workunit ")]),t("v-text-field",{attrs:{outlined:"","hide-details":"","single-line":"",label:"Time for job",required:"",type:"number",suffix:"seconds",min:60},model:{value:e.timeForJob,callback:function(a){e.timeForJob=a},expression:"timeForJob"}})],1),t("v-col",[t("div",{staticClass:"title mb-2"},[e._v("Planned end")]),t("dt-picker",{attrs:{outlined:"","hide-details":"",disabled:e.endNever,"single-line":""},model:{value:e.endDate,callback:function(a){e.endDate=a},expression:"endDate"}}),t("v-checkbox",{attrs:{label:"No time limit"},model:{value:e.endNever,callback:function(a){e.endNever=a},expression:"endNever"}})],1)],1)],1)],1)],1),e.hosts.length==0?t("v-row",{attrs:{justify:"center"}},[t("v-alert",{attrs:{outlined:"",type:"warning"}},[e._v(" This job has no hosts assigned to it and won't be able to run until edited! ")])],1):e._e(),e.timeForJob<180?t("v-row",{attrs:{justify:"center"}},[t("v-alert",{attrs:{outlined:"",type:"warning"}},[e._v(" Setting extremely low time per workunit leads to high overhead. The cracking may take much longer than estimated. Consider choosing a higher value. ")])],1):e._e(),t("v-row",{staticClass:"mb-5 mt-2",attrs:{justify:"center"}},[t("template-modal",{attrs:{"inherited-name":e.selectedTemplateName},on:{templatesUpdated:e.fetchTemplates}}),t("v-btn",{staticClass:"ml-2",attrs:{large:"",color:"primary"},on:{click:e.submit}},[t("v-icon",{attrs:{left:""}},[e._v(" "+e._s(e.hosts.length>0?"mdi-check":"mdi-content-save")+" ")]),e._v(" "+e._s(e.hosts.length>0?"Create":"Save for later")+" ")],1)],1)],1)],1)],1)},Jt=[];const Wt={name:"AddJob",components:{FileUploader:ue,combinator:be,maskattack:ze,dictionary:nt,hybridMaskWordlist:mt,hybridWordlistMask:kt,pcfgAttack:Dt,princeAttack:jt,"fc-textarea":me,"host-selector":ve,"template-modal":Bt,dtPicker:he},data:function(){return{loading:!1,hashTypes:[],showEstimatedTime:!1,estimatedTime:null,keyspace:null,gotBinaryHash:!1,hashListError:!1,selectedTemplateName:"",attacks:ce,templates:[{name:"Empty",id:0}]}},computed:b(_(_(_({},de("jobForm",["selectedTemplate"])),v("jobForm",h(["step","attackSettingsTab","validatedHashes","name","inputMethod","hashList","hashType","ignoreHashes","startDate","endDate","template","comment","hosts","startNow","endNever","timeForJob"]))),H("jobForm",["jobSettings","valid","validAttackSpecificSettings","keyspaceKnown"])),{templateItems(){return this.templates.map((e,s)=>({text:e.template,value:s}))},invalidHashes(){return this.validatedHashes.filter(e=>e.result!=="OK")},dev(){return localStorage.getItem("testmode")=="true"}}),watch:{jobSettings(e){if(e.attack_settings!=!1&&this.validAttackSpecificSettings){var s=[];for(let a=0;a<this.hosts.length;a++)s.push(this.hosts[a].id);var t=this.hashType==null?-1:this.hashType.code;this.axios.get(this.$serverAddr+"/job/crackingTime",{params:{hash_type_code:t,boinc_host_ids:s.join(","),attack_settings:e.attack_settings}}).then(a=>{a.data&&(this.estimatedTime=a.data.display_time,this.keyspace=a.data.keyspace)})}}},mounted:function(){this.loadSettings(),this.getHashTypes(),this.startDate=this.$moment().format("YYYY-MM-DDTHH:mm"),this.endDate=this.$moment().format("YYYY-MM-DDTHH:mm"),this.hashList.length>0&&this.validateHashes(),this.fetchTemplates()},methods:b(_({},D("jobForm",["applyTemplate"])),{numberFormat:x,attackIcon:oe,async loadSettings(){if(!this.timeForJob){const e=await this.axios.get(this.$serverAddr+"/settings").then(s=>s.data);this.timeForJob=e.default_seconds_per_workunit}},fetchTemplates(){this.axios.get(this.$serverAddr+"/template").then(e=>{e.data&&e.data.items&&(this.templates=[{name:"Empty",id:0},...e.data.items])}).catch(console.error)},fetchAndApplyTemplate(e){if(e==0){this.applyTemplate(),this.selectedTemplateName="",this.$store.commit("jobForm/selectedTemplateMut",0),this.loadSettings();return}this.axios.get(this.$serverAddr+`/template/${e}`).then(s=>{if(s.data&&s.data.template){const t=JSON.parse(s.data.template);this.applyTemplate(t),this.selectedTemplateName=t.template,this.$store.commit("jobForm/selectedTemplateMut",e)}}).catch(console.error)},hashTypeFilter({name:e,code:s},t){const a=t.toLowerCase();return e.toLowerCase().includes(a)||s.toLowerCase().includes(a)},subHashtypeChanged:function(e,s){this.hashType.code=this.hashType.code.replace(e,s.code),this.validateHashes(null)},focusTextarea:function(){this.$refs.textarea.focus()},validateHashes:function(e=null){e===null&&(e=this.hashList),e.split(`
`),e.startsWith("BASE64:")?this.gotBinaryHash=!0:this.gotBinaryHash=!1,!(this.hashType===null||isNaN(this.hashType.code))&&e!==""&&this.axios.post(this.$serverAddr+"/job/verifyHash",{hashtype:this.hashType.code,hashes:e}).then(s=>{this.hashListError=s.data.error,this.validatedHashes=s.data.items})},unvalidateHashes:function(e){this.validatedHashes=[]},getHashTypes:function(){this.axios.get(this.$serverAddr+"/hashcat/hashTypes").then(e=>{this.hashTypes=e.data.hashtypes})},addHash:function(e){var s=this.hashList.split(`
`),t=s[s.length-1];t===""?this.hashList=this.hashList+e:this.hashList=this.hashList+`
`+e},uploadComplete:function(e){this.$success("Successfully extracted hash form file."),this.hashType=this.hashTypes.find(s=>s.code==e.hash_type),this.addHash(e.hash),this.validateHashes(null)},isBinaryFile:function(e){for(var s=0;s<24;s++){var t=e.charCodeAt(s);if(t===65533||t<=8)return!0}return!1},hashFileSelected:function(e){var s=new FileReader;s.onloadend=function(t){if(t.target.readyState==FileReader.DONE)if(this.isBinaryFile(t.target.result)){var a=new FileReader;a.onloadend=function(n){n.target.readyState==FileReader.DONE&&(this.hashList="BASE64:"+n.target.result.substr(n.target.result.indexOf(",")+1),this.validateHashes(null),this.gotBinaryHash=!0)}.bind(this),a.readAsDataURL(e)}else{var r=this.hashList.split(`
`),i=r[r.length-1];i===""?this.hashList+=t.target.result:this.hashList+=`
`+t.target.result,this.validateHashes(null)}}.bind(this),s.readAsText(e,"utf-8")},clearInput(){this.hashType=null,this.hashList="",this.unvalidateHashes()},submit(){if(this.name===""){this.$error("Job name can not be empty.");return}if(this.inputMethod==="encryptedFile"&&!this.$refs.encryptedFileUploader.fileUploaded){this.$error("No file uploaded."),this.step=1;return}if(this.hashType===null){this.$error("No hash type selected."),this.step=1;return}if(this.invalidHashes.length>0&&!this.ignoreHashes){this.$error("Some hashes are invalid."),this.step=1;return}if(this.validatedHashes.length==0){this.$error("List of validated hashes is empty."),this.step=1;return}if(!this.attackSettingsTab){this.$error("No attack selected."),this.step=2;return}if(this.jobSettings.attack_settings===!1){this.$error("Error in attack settings."),this.step=2;return}if(this.keyspace>18446744e12){this.$error("Job keyspace is higher than maximal allowed value 2^64."),this.step=2;return}if(this.timeForJob<10){this.$error("Time per workunit must be higher or equal to 10 seconds."),this.step=4;return}if(!this.valid){this.$error("Error in attack settings."),this.step=2;return}this.loading=!0,this.axios.post(this.$serverAddr+"/job",this.jobSettings).then(e=>{this.$router.push({name:"jobDetail",params:{id:e.data.job_id}}),this.applyTemplate()}).catch(e=>{this.loading=!1})},getRandomHash(){const e=Math.random().toString(36).substring(2,6);this.hashList+=`${pe(e)}
`,this.hashType={code:"100",name:"SHA1"},this.comment+=`(${e}) `,this.validateHashes()},generateJobName(){this.name="job-"+this.$moment().format("DD-MM-YYYY-HH-mm")}})},G={};var Ut=l(Wt,qt,Jt,!1,Kt,"5d0720da",null,null);function Kt(e){for(let s in G)this[s]=G[s]}var ca=function(){return Ut.exports}();export{ca as default};

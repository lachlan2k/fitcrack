import{i as r}from"./index.09a07ba8.js";import{n as d}from"./index.a863b22b.js";import"./index.a9d6c6c2.js";import"./vendor.6aa46313.js";var c=function(){var e=this,i=e.$createElement,s=e._self._c||i;return s("div",{staticClass:"cont"},[s("div",{staticClass:"d-flex justify-space-between align-center px-4 pt-2"},[s("v-switch",{staticClass:"mr-4",attrs:{label:"View hidden hosts","prepend-icon":e.viewHidden?"mdi-eye-off":"mdi-eye"},model:{value:e.viewHidden,callback:function(t){e.viewHidden=t},expression:"viewHidden"}}),s("v-text-field",{staticClass:"px-2 pt-3",attrs:{clearable:"","prepend-inner-icon":"mdi-table-search",label:"Search","single-line":""},on:{input:e.updateList},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),s("v-divider"),s("v-data-table",{ref:"table",attrs:{headers:e.headers,items:e.hosts,search:e.search,options:e.pagination,"server-items-length":e.totalItems,loading:e.loading,"footer-props":{itemsPerPageOptions:[25,50,100],itemsPerPageText:"Hosts per page"},"fixed-header":""},on:{"update:options":function(t){e.pagination=t}},scopedSlots:e._u([{key:"item.domain_name",fn:function(t){var a=t.item;return[s("router-link",{staticClass:"middle font-weight-bold",attrs:{to:{name:"hostDetail",params:{id:a.id}}}},[e._v(" "+e._s(a.domain_name+" ("+e.fixUserNameEncoding(a.user.name)+")")+" ")])]}},{key:"item.jobs",fn:function(t){var a=t.item;return[e._v(" "+e._s(a.jobs.map(function(n){return n.status===10?1:0}).reduce(function(n,o){return n+o},0))+" ")]}},{key:"item.p_model",fn:function(t){var a=t.item;return[s("span",{staticClass:"oneline"},[e._v(e._s(a.p_model.replace(/(?:\(R\)|\(TM\)|Intel|AMD)/g,"")))])]}},{key:"item.last_active",fn:function(t){var a=t.item;return[a.last_active.seconds_delta>61?s("span",[e._v(e._s(e.parseTimeDelta(a.last_active.last_seen)))]):s("v-icon",{attrs:{color:"success"}},[e._v(" mdi-power ")])]}},{key:"item.deleted",fn:function(t){var a=t.item;return[s("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(n){var o=n.on;return[s("v-btn",e._g({staticClass:"mx-0",attrs:{icon:""},on:{click:function(h){return e.hideHost(a.id)}}},o),[s("v-icon",[e._v(" "+e._s(a.deleted?"mdi-eye":"mdi-eye-off")+" ")])],1)]}}],null,!0)},[s("span",[e._v(e._s(a.deleted?"Show":"Hide"))])])]}}])})],1)},u=[];const m={name:"HostsView",data:function(){return{interval:null,search:"",viewHidden:!1,totalItems:0,pagination:{},loading:!0,headers:[{text:"Name",align:"start",value:"domain_name"},{text:"IP address",value:"ip_address",align:"end",sortable:!1},{text:"Operating system",value:"os_name",align:"end",sortable:!1},{text:"Processor",value:"p_model",align:"end",width:"200",sortable:!1},{text:"Active jobs",value:"jobs",align:"center",sortable:!1},{text:"Online",value:"last_active",align:"center",sortable:!1},{text:"Show or hide",value:"deleted",sortable:!1,align:"center"}],hosts_statuses:[],hosts:[]}},watch:{pagination:{handler:"updateList",deep:!0},"$route.name":"updateList",viewHidden:"updateList"},mounted(){this.interval=setInterval(function(){this.loadHosts()}.bind(this),5e3)},beforeDestroy:function(){clearInterval(this.interval)},methods:{parseTimeDelta:function(e){return e!=null?this.$moment.utc(e).fromNow():"Unknown"},loadHosts(){this.axios.get(this.$serverAddr+"/hosts",{params:{page:this.pagination.page,per_page:this.pagination.itemsPerPage,order_by:this.pagination.sortBy[0],descending:this.pagination.sortDesc[0],name:this.search,showDeleted:this.viewHidden}}).then(e=>{this.hosts=e.data.items,this.totalItems=e.data.total,this.loading=!1})},updateList(){this.loading=!0,this.loadHosts()},hideHost:function(e){this.loading=!0,this.axios.delete(this.$serverAddr+"/hosts/"+e).then(i=>{this.loadHosts()})},fixUserNameEncoding:function(e){return r.decode(r.encode(e,"latin1"),"utf-8")}}},l={};var v=d(m,c,u,!1,p,"cdf44064",null,null);function p(e){for(let i in l)this[i]=l[i]}var x=function(){return v.exports}();export{x as default};
